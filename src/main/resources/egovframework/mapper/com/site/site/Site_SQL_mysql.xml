<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="siteDAO">
	<resultMap id="site" type="egovframework.com.site.service.SiteVO">
		<result property="seq" column="seq" />
		<result property="userSeq" column="user_seq" />
		<result property="url" column="url" />
		<result property="version" column="version" />
		<result property="fileName" column="file_name" />
		<result property="filePath" column="file_path" />
		<result property="ctime" column="ctime" />
		<result property="cdate" column="cdate" />
		<result property="utime" column="utime" />
		<result property="udate" column="udate" />
		<result property="dtime" column="dtime" />
		<result property="ddate" column="ddate" />
	</resultMap>
	
	<insert id="insertSite">
		<![CDATA[
			INSERT INTO site 
				( seq
				  , user_seq
				  , url
				  , version
				  , file_name
				  , file_path
				  , ctime
				  , cdate
				  , utime
				  , udate
				  , dtime
				  , ddate )
			VALUES ( #{seq}
				  , #{userSeq}
				  , #{url}
				  , #{version}
				  , #{fileName}
				  , #{filePath}
				  , #{ctime}
				  , #{cdate}
				  , #{utime}
				  , #{udate}
				  , #{dtime}
				  , #{ddate} )
		]]>
	</insert>
	
	<update id="updateSite">
		<![CDATA[
			UPDATE site
			SET seq=#{seq}
				, user_seq=#{userSeq}
				, url=#{url}
				, version=#{version}
				, file_name=#{fileName}
				, file_path=#{filePath}
				, ctime=#{ctime}
				, cdate=#{cdate}
				, utime=#{utime}
				, udate=#{udate}
				, dtime=#{dtime}
				, ddate=#{ddate}
			]]>
	</update>
	
	<delete id="deleteSite">
		<![CDATA[
			DELETE FROM site 
			]]>
	</delete>
	
	<select id="selectSite" resultMap="site">
		<![CDATA[
			SELECT
				seq
				, user_seq
				, url
				, version
				, file_name
				, file_path
				, ctime
				, cdate
				, utime
				, udate
				, dtime
				, ddate
			FROM site
			]]>
	</select>

	<select id="selectSiteList" parameterType="egovframework.com.site.service.SiteVO" resultType="egovMap">
			SELECT
								SEQ
								, USER_SEQ
								, URL
								, VERSION
								, FILE_NAME
								, FILE_PATH
								, CTIME
								, CDATE
								, UTIME
								, UDATE
								, DTIME
								, DDATE
					FROM SITE
			WHERE 1=1
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					SEQ = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					USER_SEQ LIKE CONCAT('%',#{searchKeyword},'%')
				</if>
			</if>
				ORDER BY SEQ
				limit #{recordCountPerPage} offset #{firstIndex}	
	</select>
	<select id="selectSiteListBySeq" parameterType="int" resultType="egovMap">
			SELECT
								SEQ
								, USER_SEQ
								, URL
								, VERSION
								, FILE_NAME
								, FILE_PATH
								, CTIME
								, CDATE
								, UTIME
								, UDATE
								, DTIME
								, DDATE
					FROM SITE
			WHERE 1=1 AND USER_SEQ = #{userSeq}
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					SEQ = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					USER_SEQ LIKE CONCAT('%',#{searchKeyword},'%')
				</if>
			</if>
				ORDER BY SEQ
				limit #{recordCountPerPage} offset #{firstIndex}	
	</select>	
	<select id="selectSiteListTotCnt" parameterType="egovframework.com.site.service.SiteVO" resultType="int">
			SELECT COUNT(*) totcnt
			FROM SITE
			WHERE 1=1
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					seq = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					user_seq LIKE CONCAT('%',#{searchKeyword},'%')
				</if>
			</if>			
	</select>
	<select id="selectSiteListBySeqTotCnt" parameterType="egovframework.com.site.service.SiteVO" resultType="int">
			SELECT COUNT(*) totcnt
			FROM SITE
			WHERE 1=1 AND USER_SEQ = #{userSeq}
			<if test="searchKeyword != null and searchKeyword != ''">
				<if test="searchCondition == 0">AND
					seq = #{searchKeyword}
				</if>
				<if test="searchCondition == 1">AND
					user_seq LIKE CONCAT('%',#{searchKeyword},'%')
				</if>
			</if>			
	</select>
</mapper>
